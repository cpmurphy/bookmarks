<% content_for :title, "Bookmarks" %>

<% if notice %>
  <div class="notice"><%= notice %></div>
<% end %>

<header class="page-header">
  <h1>Bookmarks</h1>

  <%= form_with url: bookmarks_path, method: :get, data: { turbo_frame: "bookmarks", turbo_action: "advance" }, class: "search-form" do |form| %>
    <%= form.search_field :query,
        value: params[:query],
        placeholder: "Search bookmarks...",
        class: "search-input",
        data: { controller: "search", action: "input->search#submit" } %>
  <% end %>

  <div class="actions">
    <% if authenticated? %>
      <%= button_to "New bookmark", new_bookmark_path, method: :get, class: "button primary" %>
      <%= button_to "Sign out", session_path, method: :delete, class: "button" %>
    <% else %>
      <%= button_to "Sign in", new_session_path, method: :get, class: "button" %>
    <% end %>
  </div>
</header>

<%= turbo_frame_tag "bookmarks" do %>
  <div class="bookmarks-container">
    <% if @bookmarks.any? %>
      <%= render partial: "bookmark", collection: @bookmarks %>
    <% else %>
      <p class="no-results">No bookmarks found</p>
    <% end %>
  </div>
<% end %>

<% if authenticated? %>
  <section class="import-section">
    <h2>Import Bookmarks</h2>
    <%= form_tag import_bookmarks_path, multipart: true, class: "import-form" do %>
    <div class="file-input-wrapper">
      <%= file_field_tag :file, class: "file-input", accept: "application/json" %>
        <%= submit_tag "Import JSON", class: "button" %>
      </div>
    <% end %>
  </section>
<% end %>
